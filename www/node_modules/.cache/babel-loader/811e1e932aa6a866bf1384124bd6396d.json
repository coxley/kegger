{"ast":null,"code":"import React from'react';import useWebSocket from'react-use-websocket';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function App(){var stats=useStats();var latestPour=usePours();return/*#__PURE__*/_jsx(\"div\",{className:\"h-screen w-screen bg-blue-200\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-6 grid-rows-6 h-screen\",children:Object.entries(stats.records).map(function(item){var name=item[0];var records=item[1];var total_ounces=0;var total_pulses=0;for(var rec in records){total_ounces+=records[rec].ounces;total_pulses+=records[rec].pulses;}var classes=\"\";if(name===\"1\"){classes=\"col-start-2 col-end-4\";}else if(name===\"2\"){classes=\"col-start-4 col-end-6\";}var pourStatus=latestPour.tap.toString()===name&&latestPour.active?/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-500\",children:[latestPour.ounces.toFixed(2),\"oz\"]}):/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-500\",children:\"Inactive\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"row-start-2 row-end-5 bg-gray-100 border-gray-800 rounded-md shadow-md h-auto m-10\"+\" \"+classes,children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-end h-12 border-b-gray-300 shadow-sm border-b bg-gray-50\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"pb-2 pl-2\",children:[\"Tap \",name]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"isolate flex flex-col px-2 pt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-left font-medium\",children:\"Pour Status\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-right\",children:pourStatus})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-left font-medium\",children:\"Total Pours\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-right\",children:records.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-left font-medium\",children:\"Total Ounces\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-right\",children:[total_ounces.toFixed(2),\"oz\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-left font-medium\",children:\"Total Pulses\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-right\",children:total_pulses})]})]})]});})})});}var addr=\"ws://192.168.100.126:8080/stats\";function useStats(){var _useWebSocket=useWebSocket(addr,{shouldReconnect:function shouldReconnect(_){return true;}}),lastJsonMessage=_useWebSocket.lastJsonMessage;if(!lastJsonMessage){return{total_pulses:0,total_ounces:0,records:[]};}return lastJsonMessage;}var pourAddr=\"ws://192.168.100.126:8080/pours\";function usePours(){var _useWebSocket2=useWebSocket(pourAddr,{shouldReconnect:function shouldReconnect(_){return true;}}),lastJsonMessage=_useWebSocket2.lastJsonMessage;if(!lastJsonMessage){return{timestamp:0,tap:0,active:false,pulses:0,ounces:0};}// TODO: adjust to allow both to be active\n// TODO: flow rate, etc\nreturn lastJsonMessage;}export default App;","map":{"version":3,"names":["React","useWebSocket","App","stats","useStats","latestPour","usePours","Object","entries","records","map","item","name","total_ounces","total_pulses","rec","ounces","pulses","classes","pourStatus","tap","toString","active","toFixed","length","addr","shouldReconnect","_","lastJsonMessage","pourAddr","timestamp"],"sources":["/home/coxley/kegger/web/src/App.tsx"],"sourcesContent":["import React, { useEffect, useReducer, useState } from 'react';\n\nimport useWebSocket from 'react-use-websocket';\n\n\nfunction App() {\n  const stats = useStats()\n  const latestPour = usePours()\n  return (\n    <div className=\"h-screen w-screen bg-blue-200\">\n      <div className=\"grid grid-cols-6 grid-rows-6 h-screen\">\n        {Object.entries(stats.records).map((item) => {\n          const name = item[0]\n          const records = item[1]\n\n          let total_ounces = 0\n          let total_pulses = 0\n          for (let rec in records) {\n            total_ounces += records[rec].ounces\n            total_pulses += records[rec].pulses\n          }\n          let classes = \"\"\n          if (name === \"1\") {\n            classes = \"col-start-2 col-end-4\"\n          } else if (name === \"2\") {\n            classes = \"col-start-4 col-end-6\"\n          }\n\n\n          const pourStatus = (latestPour.tap.toString() === name && latestPour.active) ? <span className=\"text-green-500\">{latestPour.ounces.toFixed(2)}oz</span> : <span className=\"text-orange-500\">Inactive</span>\n          return (\n            <div className={\"row-start-2 row-end-5 bg-gray-100 border-gray-800 rounded-md shadow-md h-auto m-10\" + \" \" + classes}>\n              <div className=\"flex items-end h-12 border-b-gray-300 shadow-sm border-b bg-gray-50\">\n                <span className=\"pb-2 pl-2\">\n                  Tap {name}\n                </span>\n              </div>\n              <div className=\"isolate flex flex-col px-2 pt-4\">\n                <div className=\"flex flex-row justify-between\">\n                  <span className=\"text-left font-medium\">Pour Status</span>\n                  <span className=\"text-right\">{pourStatus}</span>\n                </div>\n                <div className=\"flex flex-row justify-between\">\n                  <span className=\"text-left font-medium\">Total Pours</span>\n                  <span className=\"text-right\">{records.length}</span>\n                </div>\n                <div className=\"flex flex-row justify-between\">\n                  <span className=\"text-left font-medium\">Total Ounces</span>\n                  <span className=\"text-right\">{total_ounces.toFixed(2)}oz</span>\n                </div>\n                <div className=\"flex flex-row justify-between\">\n                  <span className=\"text-left font-medium\">Total Pulses</span>\n                  <span className=\"text-right\">{total_pulses}</span>\n                </div>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    </div >\n  );\n}\n\ninterface Stats {\n  total_pulses: number,\n  total_ounces: number,\n  records: { [tap: number]: Record[] },\n}\n\ninterface Record {\n  timestamp: number,\n  tap: number,\n  pulses: number,\n  ounces: number,\n}\n\nconst addr = \"ws://192.168.100.126:8080/stats\"\nfunction useStats(): Stats {\n  const { lastJsonMessage } = useWebSocket(addr, {\n    shouldReconnect: (_) => true,\n  });\n\n  if (!lastJsonMessage) {\n    return { total_pulses: 0, total_ounces: 0, records: [] }\n  }\n  return lastJsonMessage as unknown as Stats\n}\n\nconst pourAddr = \"ws://192.168.100.126:8080/pours\"\ntype pourState = {\n  timestamp: number, tap: number, active: boolean, pulses: number, ounces: number\n}\nfunction usePours(): pourState {\n  const { lastJsonMessage } = useWebSocket(pourAddr, {\n    shouldReconnect: (_) => true,\n  });\n\n  if (!lastJsonMessage) {\n    return { timestamp: 0, tap: 0, active: false, pulses: 0, ounces: 0 }\n  }\n\n  // TODO: adjust to allow both to be active\n  // TODO: flow rate, etc\n  return lastJsonMessage as unknown as pourState\n}\n\n\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}